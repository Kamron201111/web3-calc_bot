<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Web3 Super Calculator DApp</title>
  <!-- Web3.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.10.0/web3.min.js"></script>
  <!-- Kuchli matematik kutubxona -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
  <style>
    body {
      background: #05060a;
      color: #fff;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      text-align: center;
      padding: 30px 12px;
    }
    h1 {
      margin-bottom: 18px;
    }
    .card {
      max-width: 480px;
      margin: 0 auto 20px auto;
      padding: 20px 16px 24px;
      background: radial-gradient(circle at top, #222b3b, #111319);
      border-radius: 16px;
      box-shadow: 0 0 20px rgba(0,0,0,0.5);
    }
    .section-title {
      font-size: 20px;
      margin: 10px 0 8px;
    }
    .subtitle {
      font-size: 13px;
      opacity: 0.8;
      margin-bottom: 8px;
    }
    input, select {
      width: 100%;
      max-width: 440px;
      padding: 10px 12px;
      margin: 6px 0;
      border-radius: 10px;
      border: none;
      font-size: 16px;
      box-sizing: border-box;
    }
    button {
      padding: 10px 14px;
      margin-top: 10px;
      font-size: 16px;
      background: #2563eb;
      color: #fff;
      border: none;
      border-radius: 999px;
      cursor: pointer;
      min-width: 180px;
    }
    button:hover {
      filter: brightness(1.05);
    }
    .btn-secondary {
      background: #1f2937;
      margin: 4px;
      min-width: 60px;
    }
    .btn-fn {
      background: #111827;
      font-size: 14px;
      min-width: 70px;
    }
    #result, #fxResult {
      font-size: 18px;
      margin-top: 10px;
      min-height: 22px;
    }
    #wallet {
      word-break: break-all;
      font-size: 13px;
    }
    .row {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 4px;
      margin-top: 6px;
    }
    .label-row {
      text-align: left;
      font-size: 13px;
      opacity: 0.85;
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <h1>Web3 Super Calculator DApp</h1>  <!-- Wallet -->  <div class="card">
    <div class="section-title">Wallet holati</div>
    <p id="wallet">Ulanmagan</p>
    <button onclick="connectWallet()">üîó Metamask'ga ulanish</button>
  </div>  <!-- Advanced Calculator -->  <div class="card">
    <div class="section-title">üßÆ Mukammal kalkulyator</div>
    <div class="subtitle">Oddiy, ilmiy va foizli hisob-kitoblar: +, -, *, /, %, sqrt(), sin(), cos(), tan(), log(), pi, e va boshqalar.</div><input type="text" id="expr" placeholder="Masalan: 2*sqrt(3) + sin(pi/4)" />

<div class="row">
  <button class="btn-secondary" onclick="insertToken('7')">7</button>
  <button class="btn-secondary" onclick="insertToken('8')">8</button>
  <button class="btn-secondary" onclick="insertToken('9')">9</button>
  <button class="btn-secondary" onclick="insertToken('/')">/</button>
</div>
<div class="row">
  <button class="btn-secondary" onclick="insertToken('4')">4</button>
  <button class="btn-secondary" onclick="insertToken('5')">5</button>
  <button class="btn-secondary" onclick="insertToken('6')">6</button>
  <button class="btn-secondary" onclick="insertToken('*')">*</button>
</div>
<div class="row">
  <button class="btn-secondary" onclick="insertToken('1')">1</button>
  <button class="btn-secondary" onclick="insertToken('2')">2</button>
  <button class="btn-secondary" onclick="insertToken('3')">3</button>
  <button class="btn-secondary" onclick="insertToken('-')">-</button>
</div>
<div class="row">
  <button class="btn-secondary" onclick="insertToken('0')">0</button>
  <button class="btn-secondary" onclick="insertToken('.')">.</button>
  <button class="btn-secondary" onclick="insertToken('%')">%</button>
  <button class="btn-secondary" onclick="insertToken('+')">+</button>
</div>

<div class="row">
  <button class="btn-fn" onclick="insertToken('(')">(</button>
  <button class="btn-fn" onclick="insertToken(')')">)</button>
  <button class="btn-fn" onclick="insertToken('pi')">œÄ</button>
  <button class="btn-fn" onclick="insertToken('e')">e</button>
</div>
<div class="row">
  <button class="btn-fn" onclick="insertToken('sqrt(')">sqrt</button>
  <button class="btn-fn" onclick="insertToken('sin(')">sin</button>
  <button class="btn-fn" onclick="insertToken('cos(')">cos</button>
  <button class="btn-fn" onclick="insertToken('tan(')">tan</button>
</div>
<div class="row">
  <button class="btn-fn" onclick="insertToken('log10(')">log10</button>
  <button class="btn-fn" onclick="insertToken('log(')">ln</button>
  <button class="btn-fn" onclick="insertToken('^')">^ (daraja)</button>
  <button class="btn-fn" onclick="clearExpr()">üßπ Clear</button>
</div>

<button onclick="calc()">Hisoblash</button>
<div id="result"></div>

  </div>  <!-- Currency Converter -->  <div class="card">
    <div class="section-title">üåç Valyuta konvertori</div>
    <div class="subtitle">Deyarli barcha jahon valyutalari. Kurslar onlayn API orqali olinadi.</div><div class="label-row">Miqdor</div>
<input type="number" id="curAmount" placeholder="Masalan: 100" />

<div class="label-row">Qaysi valyutadan</div>
<select id="fromCur"></select>

<div class="label-row">Qaysi valyutaga</div>
<select id="toCur"></select>

<button onclick="convertCurrency()">Hisoblash</button>
<div id="fxResult"></div>
<div class="subtitle" id="fxInfo"></div>

  </div>  <script>
    // ---------- Web3 wallet ----------
    async function connectWallet() {
      if (window.ethereum) {
        try {
          const accounts = await ethereum.request({ method: 'eth_requestAccounts' });
          document.getElementById("wallet").innerText = accounts[0];
        } catch (err) {
          alert("Ulanishda xatolik!");
        }
      } else {
        alert("Metamask o'rnatilmagan. Iltimos, brauzeringizga Metamask extension qo'shing.");
      }
    }

    // ---------- Super calculator ----------
    function insertToken(token) {
      const input = document.getElementById("expr");
      const start = input.selectionStart || input.value.length;
      const end = input.selectionEnd || input.value.length;
      input.value = input.value.slice(0, start) + token + input.value.slice(end);
      input.focus();
      const pos = start + token.length;
      input.setSelectionRange(pos, pos);
    }

    function clearExpr() {
      document.getElementById("expr").value = "";
      document.getElementById("result").innerText = "";
    }

    function calc() {
      const expr = document.getElementById("expr").value.trim();
      if (!expr) {
        document.getElementById("result").innerText = "Iltimos, ifoda kiriting.";
        return;
      }
      try {
        const res = math.evaluate(expr);
        document.getElementById("result").innerText = "Natija: " + res;
      } catch (e) {
        document.getElementById("result").innerText = "Xato ifoda yoki noto'g'ri funksiya!";
      }
    }

    // ---------- Currency converter ----------
    const currencyList = [
      "USD","EUR","UZS","RUB","GBP","JPY","CNY","KZT","TRY","CHF","CAD","AUD","AED","SAR","INR",
      "KRW","BRL","IDR","UAH","PLN","SEK","NOK","DKK","SGD","HKD","NZD","ZAR","MXN","NGN","THB"
    ];

    const fromCurSel = document.getElementById("fromCur");
    const toCurSel = document.getElementById("toCur");

    function fillCurrencies() {
      currencyList.forEach(code => {
        const opt1 = document.createElement("option");
        opt1.value = code;
        opt1.textContent = code;
        fromCurSel.appendChild(opt1);

        const opt2 = document.createElement("option");
        opt2.value = code;
        opt2.textContent = code;
        toCurSel.appendChild(opt2);
      });
      fromCurSel.value = "USD";
      toCurSel.value = "UZS";
    }

    let fxRatesCache = null;
    let fxBase = null;

    async function convertCurrency() {
      const amount = parseFloat(document.getElementById("curAmount").value);
      const from = fromCurSel.value;
      const to = toCurSel.value;
      const resultEl = document.getElementById("fxResult");
      const infoEl = document.getElementById("fxInfo");

      if (isNaN(amount)) {
        resultEl.innerText = "Iltimos, miqdor kiriting.";
        return;
      }

      try {
        if (!fxRatesCache || fxBase !== from) {
          infoEl.innerText = "Kurslar yuklanmoqda...";
          const res = await fetch(`https://api.exchangerate.host/latest?base=${from}`);
          const data = await res.json();
          fxRatesCache = data.rates;
          fxBase = from;
          infoEl.innerText = `Manba: exchangerate.host | Sana: ${data.date}`;
        }

        const rate = fxRatesCache[to];
        if (!rate) {
          resultEl.innerText = "Bu juftlik uchun kurs topilmadi.";
          return;
        }
        const converted = amount * rate;
        resultEl.innerText = `${amount} ${from} ‚âà ${converted.toFixed(4)} ${to}`;
      } catch (err) {
        resultEl.innerText = "Kurslarni olishda xatolik!";
        console.error(err);
      }
    }

    fillCurrencies();
  </script></body>
</html>
